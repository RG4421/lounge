[ ] Improve middleware
[ ] Add EventEmitter interface and events for documents
[ ] Add init and isNew
[ ] Fix transforms for inline options
